<%-include('../include/adminheader.ejs')-%>

  <body>
    
    <nav class="navbar navbar-expand-lg navbackground mb-5">
      <div class="container-fluid ">
        <a class="navbar-brand" href="/admin">Admin </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link "  href="/admin">dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/orders">Orders</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active " aria-current="page" href="/admin/products">Products</a>
            </li>
            <li class="nav-item">
              <a href="/admin/usermanagement" class="nav-link ">Users</a>
            </li>
            <li class="nav-item">
              <a href="/admin/category"   class="nav-link \">Category</a>
            </li>
            <li class="nav-item">
              <a href="/admin/logout" class="nav-link ">Sign out</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    

    <section  class="container h-100 mt-4  ">
      <h2 class="text-center">Order History</h2>
<div class="row mb-2">
  <div class="d-flex justify-content-between">
     <div class="d-flex"> <p class="input-group-addon fw-300 m-2">Search Products</p>
  
        <input id="filter" type="text" class="col-4 m-2 " placeholder="Search...">
  </div>

    <button  class="py-1 btn btn-dark" id="buttonstyle" ><a href="/admin/addproduct">Add Product</a></button>
  </div>
 
  </div>
      <div class="  table-responsive">
        <table class="table shadow  ">
          <thead class="table-dark">
            <tr>
              <th scope="col">Product name</th>
              <th scope="col">description</th>
              <th scope="col">category</th>

              <th scope="col">size</th>
              <th scope="col">stock</th>
              <th scope="col">actual price</th>
              <!-- <th scope="col">offerprice</th> -->
              <th scope="col">image</th>
              <th scope="col">action</th>
            
            </tr>
          </thead>
          <tbody class="searchable">
            
        
            
              <% for ( let i=0; i < productdetails.length; i++){ %>
                <tr >
                 
                  <td><%=productdetails[i].product_name%></td>
                    <td ><%=productdetails[i].desc%></td>
                    <td class="pt-60"><%=productdetails[i].category%></td>
                    <td class="pt-60"><%=productdetails[i].size%></td>
                    <td class="pt-60"><%=productdetails[i].stock%></td>
                    <td class="pt-60"><%=productdetails[i].price%></td>
                    <!-- <td><%=productdetails[i].offerprice%></td> -->
                    <td><img src="/<%=productdetails[i].image[0]%>" width="100" class="img-thumbnail" alt="product image"></td>
                    <td> 
                      <a href="/admin/editproduct/<%=productdetails[i]._id%>"  class="text-success"><i class="fas fa-edit fa-lg mx-1"></i></a>
                      <a onclick="confirmation('<%=productdetails[i]._id%>')"  class="text-success"><i style="color: red;" class="fas fa-trash fa-lg mx-1"></i ></a>
                    </td>
                  
                </tr>
            <%}%>
        
          </tbody>
        </table>
      </div>
    </section>
    
   


 
<script>
  function confirmation(id) {
    
// id.preventDefault();
// var urlToRedirect = id.currentTarget.getAttribute('href'); //use currentTarget because the click may be on the nested i tag and not a tag causing the href to be empty
// console.log(urlToRedirect); // verify if this is the right URL
swal({
  title: "Are you sure?",
  text: "Once deleted, you will not be able to recover this product!",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((result) => {
  // redirect with javascript here as per your logic after showing the alert using the urlToRedirect value
  if (result) {
   

    swal("file has been deleted!", {
      icon: "success",
    }).then(()=>{
       location.href = `/admin/deleteproduct/${id}`;
    })
   
  } else {
    swal("Your  file is safe!");
  }
});
}
</script>

<%-include('../include/adminresfooter.ejs')-%>