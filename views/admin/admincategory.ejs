<%-include('../include/adminheader.ejs')-%>

  <body>
    
    <nav class="navbar navbar-expand-lg navbackground mb-5">
      <div class="container-fluid ">
        <a class="navbar-brand" href="/admin">Admin </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link "  href="/admin">dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/orders">Orders</a>
            </li>
            <li class="nav-item">
              <a class="nav-link " href="/admin/products">Products</a>
            </li>
            <li class="nav-item">
              <a href="/admin/usermanagement" class="nav-link ">Users</a>
            </li>
            <li class="nav-item">
              <a href="/admin/category"  aria-current="page" class="nav-link active ">Category</a>
            </li>
            <li class="nav-item">
              <a href="/admin/logout" class="nav-link ">Sign out</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    

    
    <section  class="h-100 mt-4 col-md-6  ">
     
      <div class="container  ">
        
      </div>
    </section>
  
   <%if(message){%>
              <p class="text-<%=message.type%>"> <%=message.message%></p> 
                <%}%>
       
    <div  class="container h-100 mt-4  ">
      <h2 class="text-center">Add Category</h2>
      <div class="row mb-2">
      <div class="d-flex  justify-content-center mb-4 col-12">
        <form action="/admin/category" class="col-12 col-md-6" id="categoryform" method="post">
          <input type="text" name="category"  id="category" placeholder="New Category" class="col-8 m-2 py-2 form-control mb-3">
           <button type="submit" class="col-auto btn btn-success p-2 ">Submit</button>
          </form>
        
        </div>
        
     
      </div>
      
      <h2 class="text-center">Categories</h2>

      <div class="  table-responsive">
        <table class="table shadow  ">
          <thead class="table-dark">
            <tr>
              <th scope="col">Index</th>
              <th scope="col">category</th>

              <th scope="col">Offers available</th>
                  
                  
              <th scope="col">action</th>
            </tr>
          </thead>
          <tbody class="searchable">
            <% let i=0%>
        
            <%categories.forEach(function(categories){%>
                        <% i=i+1%>
                       
              
              <tr>
                <td><%=i%></td>
          
                <td><%=categories.categoryname%></td>
                <%if(categories.offer){%>
                  <td>YES</td>
               <%}else{%>
                <td>NO</td>
                <%}%>
            
                
         
                <td>
                  <a  id="confirm" onclick="confirmation('<%=categories._id%>')" class="btn btn-danger">delete</a></td>
                
                </tr>
              
              
             <%})%>
          </tbody>
        </table>
      </div>
    </div>
             
      


     
 
</body>
<%-include('../include/adminresfooter.ejs')-%>

<script>
  
  
  function  confirmation(id){
    swal({
  title: "Are you sure?",
  text: "Once deleted, you will not be able to recover this imaginary file!",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((willDelete) => {
  if (willDelete) {
    swal("Poof! Your  file has been deleted!", {
      icon: "success",
    }).then(()=>{
       location.href = `/admin/category/${id}`;
    })
  
    
   
  } else {
    swal("Your file is safe!");
  }
});
		}
   
    jQuery.validator.addMethod(
    "lettersonly",
    function (value, element) {
      return this.optional(element) || /^[a-z,A-Z ]+$/.test(value);
    },
    "Letters only please"
  );


    jQuery('#categoryform').validate({
    rules:{
     
      category:{
        required:true,
        lettersonly:true,
       
      }
      
   
    },messages:{
      category:{
        required:"Category is required",
        
      },
     
      
    },
    submitHandler:function(form){
      form.submit();
    }
  })

  // $("#form1").validate({
   
  //         rules: {
  //         category:{
  //            required:true,
  //            minlength:3,

           
  //           }
  //           },
  //       });
               
       
             
                 </script>
       

</script>

  
